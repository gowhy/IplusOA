@model  IPagedList<IplusOAEntity.Wish>
@using MvcContrib.UI.Grid
@using MvcContrib.Pagination;
@using MvcContrib.UI.Pager;
@using Common;

<script type="text/javascript">

 

    function Auditing(id, state) {

        var url = '@Url.Action("Auditing")' + '?wishId=' + id + "&state=" + state;
        url = encodeURI(url);
        $.ajax({
            url: url,
            //data: { id: id },
            type: 'POST',
            dataType: "json",
            success: function (obj) {
                $("#info").html(obj.Info);
                if (obj.Status == true)
                    location.href = location.href;
            }
        });
    }

</script>
<style>
    .combo {
        vertical-align: bottom;
    }
</style>

<div class="grid_box">
    <div class="grid_top">
    </div>

    <table class="grid">
        <thead>
            <tr>
                <th>编号Id</th>
                <th>姓名</th>
                <th>手机号</th>
                <th>心愿</th>
                <th>申请时间</th>
                <th>审核时间</th>
                <th>状态</th>
                <th style="width:120px;align:center;">审核</th>
            </tr>
        </thead>
        @foreach (var item in Model)
        {
            <tbody>
                <tr class="gridrow_alternate">
                    <td>@item.Id</td>
                    <td>@item.Name</td>
                    <td>@item.Phone</td>
                    <td>@item.WishDesc</td>
                    <td>@(item.ApplyTime.HasValue ? item.ApplyTime.Value.ToString("yyyy-MM-dd HH:mm") : "")</td>
                    <td>@(item.AuditeTime.HasValue ? item.AuditeTime.Value.ToString("yyyy-MM-dd HH:mm") : "")</td>
                    <td>
                        @Enum.Parse(typeof(IplusOAEntity.EnumWishState), item.State.ToString())
                    </td>
                    <td class="grid_btn">
                          @if (@item.State == 1)
                          {
                            <a href="javascript: Auditing(@item.Id,2)">通过</a>
                            <a href="javascript: Auditing(@item.Id,3)">不通过</a>
                          }
                          else
                          {
                              if (@item.State == 0)
                              {
                                  @Html.Raw("等待用户申请");
                              }
                          }


                            
                    </td>
                </tr>
            </tbody>
        }
    </table>



    <div class="grid_foot">
    </div>
</div>

@Html.Pager(Model)
